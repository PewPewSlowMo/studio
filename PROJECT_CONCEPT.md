# Концепция проекта "CallSync Central"

## 1. Общее видение

**CallSync Central** — это комплексная веб-платформа для управления и анализа работы колл-центра, предназначенная для работы в тесной интеграции с **IP-АТС Asterisk**. Система предоставляет инструменты для мониторинга в реальном времени, обработки звонков, сбора данных и глубокой аналитики. Цель платформы — повысить эффективность операторов, улучшить качество обслуживания клиентов и предоставить руководству прозрачные данные для принятия решений.

Приложение должно быть построено как единый интерфейс, который централизует все ключевые функции, необходимые для работы современного колл-центра на базе Asterisk.

---

## 2. Ключевые роли пользователей

В системе предусмотрено три основные роли с разным уровнем доступа и функциональности:

1.  **Оператор:**
    *   Основной пользователь системы, обрабатывающий входящие и исходящие звонки.
    *   Имеет доступ к своему рабочему месту, где видит информацию о текущем звонке, историю обращений клиента и заполняет карточку разговора.
    *   Может просматривать только свою личную историю звонков и задачи на перезвон.

2.  **Супервизор/Менеджер:**
    *   Отвечает за контроль качества и производительности группы операторов или всего колл-центра.
    *   Имеет доступ к дашборду в реальном времени для мониторинга статусов всех операторов и активных звонков.
    *   Может просматривать расширенные отчеты по производительности операторов, очередям и пропущенным вызовам.
    *   Имеет доступ к аналитическим данным и KPI.

3.  **Администратор:**
    *   Обладает полными правами в системе.
    *   Управляет учетными записями всех пользователей (создание, редактирование, деактивация).
    *   Настраивает системные подключения к внешним сервисам, в первую очередь к **серверу Asterisk** (через AMI и ARI) и базе данных звонков (CDR).
    *   Выполняет "связку" технических сущностей из Asterisk (внутренние номера, номера очередей) с логическими (пользователи, названия отделов).

---

## 3. Основные функциональные модули

### 3.1. Модуль аутентификации

*   **Вход в систему:** Пользователи входят в систему по email и паролю.
*   **Управление сессией:** Система должна запоминать пользователя после входа.
*   **Разделение по ролям:** После входа пользователь должен перенаправляться на соответствующий его роли экран, и доступ к другим разделам должен быть ограничен.

### 3.2. Дашборд в реальном времени (для Супервизоров/Администраторов)

Это главный экран для мониторинга активности колл-центра "здесь и сейчас", получающий данные напрямую из Asterisk.

*   **Ключевые показатели (KPI):** Отображение карточек с основными метриками: общее количество операторов, сколько из них онлайн, сколько заняты в разговоре (на основе статусов их SIP-ендпоинтов), количество активных очередей.
*   **Статусы операторов:** Список всех операторов с их текущим статусом (онлайн, в разговоре, оффлайн), который обновляется в реальном времени через подключение к Asterisk.
*   **Активные звонки:** Таблица, показывающая все текущие разговоры с информацией: кто звонит, какой оператор отвечает, из какой очереди пришел звонок.
*   **График нагрузки:** Визуальный график, показывающий распределение звонков по часам в течение текущего дня, построенный на основе данных из CDR.

### 3.3. Рабочее место оператора

Это основной интерфейс для оператора, который должен динамически реагировать на события телефонии.

*   **Отображение статуса:** Оператор должен видеть свой текущий статус (например, "Доступен", "В разговоре"), полученный от Asterisk.
*   **Автоматическая карточка звонка:** При поступлении входящего звонка на внутренний номер оператора должна автоматически появляться "карточка", содержащая:
    *   Номер телефона звонящего (определенный Asterisk).
    *   Информацию о клиенте из CRM, если номер найден в базе (ФИО, адрес, заметки).
    *   Краткую историю последних 5-10 обращений этого клиента.
*   **Форма для заполнения:** В карточке должны быть поля для заполнения оператором:
    *   Категория звонка (жалоба, консультация, запись и т.д.).
    *   Подробное описание сути обращения.
    *   Результат разговора (проблема решена, переведен на старшего и т.д.).
    *   Оценка удовлетворенности клиента.
    *   Заметки.
    *   Возможность поставить отметку "Требуется перезвонить".
*   **Логика сохранения:** Оператор должен иметь возможность сохранять информацию в карточке во время разговора. После завершения звонка (событие от Asterisk) у оператора должно быть дополнительное время (например, 60 секунд) на финальное редактирование, после чего карточка автоматически сохраняется и закрывается.
*   **Список задач на перезвон:** Отдельный блок, где оператор видит список клиентов, которым он должен перезвонить (на основе отметки "Требуется обратная связь").

### 3.4. Отчеты и аналитика

Этот раздел предназначен для анализа исторических данных, полученных из базы данных **Call Detail Records (CDR) Asterisk**.

*   **Фильтр по дате:** Все отчеты должны поддерживать выбор произвольного периода времени.
*   **Отчет по операторам:** Сводная таблица с показателями по каждому оператору за выбранный период: количество принятых и пропущенных звонков, общее и среднее время разговора, средняя оценка удовлетворенности. Должна быть возможность посмотреть детализацию по всем звонкам конкретного оператора.
*   **Отчет по очередям:** Таблица с аналитикой по каждой очереди вызовов: общее количество звонков, процент отвеченных и потерянных, среднее время ожидания в очереди, SLA (процент звонков, отвеченных за заданное время, например, 30 секунд).
*   **Отчет по пропущенным звонкам:** Детальный список всех неотвеченных вызовов с указанием номера, времени ожидания и предполагаемой причины (например, "все операторы были заняты", "клиент повесил трубку"), основанный на статусах `disposition` из CDR.
*   **Экспорт данных:** Возможность выгрузки отчетов в формате, совместимом с Excel (например, CSV или XLSX).

### 3.5. Интеллектуальный анализ звонков (AI)

*   **Функция суммаризации:** Отдельный инструмент, куда можно загрузить аудиозапись разговора (полученную с сервера Asterisk) и его текстовую расшифровку.
*   **Анализ:** Искусственный интеллект должен проанализировать предоставленные данные и выдать структурированный результат:
    *   **Краткое резюме:** Сжатое изложение сути разговора.
    *   **Категоризация:** Автоматическое определение тем звонка (например, "вопрос по счету", "техническая проблема").
    *   **Определение тональности:** Оценка общего настроения разговора (позитивное, негативное, нейтральное).
*   **Назначение:** Этот инструмент предназначен для помощи в контроле качества и быстрой оценки содержания звонков без полного прослушивания.

### 3.6. Администрирование

Раздел для настройки и управления системой.

*   **Управление пользователями:** Полный CRUD (создание, чтение, редактирование, удаление) для пользователей всех ролей.
*   **Настройки подключений:** Интерфейс для ввода и сохранения учетных данных для подключения к **серверу Asterisk (AMI, ARI)** и базе данных CDR. Должна быть предусмотрена функция тестирования каждого подключения.
*   **Управление связками:** Интерфейс, где администратор может:
    *   Привязать технические номера (ендпоинты) из системы телефонии к конкретным пользователям-операторам.
    *   Присвоить человекопонятные имена техническим номерам очередей (например, очередь "701" -> "Отдел продаж").
    *   Должна быть кнопка для принудительного обновления списков номеров и очередей с сервера Asterisk.
